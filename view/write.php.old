<?php
header("Content-type: text/html; charset=utf-8");

require_once(__DIR__.'/../model/FacebookUtils.php');
$fbUtils = new FacebookUtils();
$fbUtils->checkLogin();

// 選択した選択肢の番号を取得
if(isset($_POST['result'])) {
	$index = $_POST['result'];

} else {
	$msg = "エラーが発生しました。アプリのトップ画面にお戻りください。<br />";
	$msg = $msg ."<a href='./index.php'>戻る</a>";

}
// 質問データ
$confUrl = file_get_contents(__DIR__.'/../model/'.ApplicationConstants::settingJsonPath);
$confObj = json_decode(file_get_contents($confUrl), true);

echo "POST: " .$_POST['result'];
echo "結果：" .$confObj['results'][$index]['message'];
echo "画像URL：" .$confObj['results'][$index]['image'];

if(isset($confObj['results'][$index]['message'])
	&& isset($confObj['results'][$index]['message'])) {
	// Wallに書き込み
	$writeStr = "テスト投稿";
	$fbUtils->writePhotoMe(
		$confObj['results'][$index]['message'],
		$confObj['results'][$index]['image']
	);
}
?>

<h1>プログラマ診断</h1>

<div style="width: 300px; padding:10px; border: gray solid 1px;">
<?php echo $confObj['results'][$index]['message']; ?>
</div>

<p>
をウォールに投稿しました。
</p>
<p>
<a href="http://www.facebook.com/codingManiacs">コーディングマニアックスへ</a>
</p>

